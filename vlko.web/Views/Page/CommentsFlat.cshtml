@model vlko.core.Components.PagedModel<vlko.model.Action.ViewModel.CommentViewModel>
@using vlko.web.Controllers;
@using vlko.core.Components;
@using vlko.web.ViewModel.Page;
@{
	Html.ScriptInclude("~/Scripts/Grid.js");
}
<section class="flat_comments cleaner">
@foreach (var item in Model)
{ 
	<article class="comment cleaner">
		<div class="author" title="Author">@((item.Owner == null) ? "anonymous-" + item.AnonymousName : item.Owner.Name)</div>
		<div class="last-change-date" title="Date">@String.Format("{0:g}", item.CreatedDate)@(item.Changed ? " ver. " + item.Version : string.Empty)</div>
		<a class="icon-link reply_link" title="Reply" rel="@item.Id.ToString()" href="@Url.RouteUrl("PageCommentReply", routeValues: new
																			{
																				friendlyUrl = Html.ViewContext.RouteData.GetRequiredString("friendlyUrl"),
																				parentId = item.Id,
																				sort = Html.ViewContext.RouteData.GetRequiredString("sort")
																			})"><img src="@Url.Content("~/Content/images/comment.gif")" alt="Comment"/></a>
		<div class="title">@Html.Raw(item.Name)</div>
		<div class="text">@Html.Raw(item.Text)</div>
	</article>
}
</section>
@Html.Partial("~/Views/Shared/Pager.cshtml", 
		new PagerModel(
			Model,
			Html.ViewContext.RouteData.GetRequiredString("friendlyUrl") + "/" + Html.ViewContext.RouteData.GetRequiredString("sort")), 
			new ViewDataDictionary(new { content = "page_view_content" }))

